# Руководство по локализации TorrentClient

## Обзор

Проект TorrentClient поддерживает полную локализацию интерфейса на 50+ языках мира. Система локализации использует стандартные .NET ресурсные файлы (.resx) и автоматически определяет язык из настроек Windows.

**Текущий статус переводов:** ✅ **Все 50 языков полностью переведено (100%)!**

**Полностью переведенные языки (50):**
- Английский (en) - базовый
- Русский (ru), Испанский (es), Французский (fr), Немецкий (de), Итальянский (it), Португальский (pt)
- Голландский (nl), Польский (pl), Чешский (cs), Шведский (sv), Датский (da), Норвежский (no), Финский (fi)
- Турецкий (tr), Украинский (uk), Румынский (ro), Венгерский (hu), Греческий (el), Болгарский (bg)
- Хорватский (hr), Словацкий (sk), Сербский (sr), Словенский (sl), Эстонский (et), Латышский (lv), Литовский (lt)
- Японский (ja), Корейский (ko), Китайский упрощенный (zh-CN), Китайский традиционный (zh-TW), Китайский общий (zh)
- Арабский (ar), Иврит (he), Хинди (hi), Индонезийский (id), Вьетнамский (vi), Тайский (th)
- Македонский (mk), Албанский (sq), Исландский (is), Ирландский (ga), Мальтийский (mt)
- Валлийский (cy), Баскский (eu), Каталанский (ca), Галисийский (gl)
- Региональные варианты: Португальский Бразильский (pt-BR), Испанский Мексиканский (es-MX), Испанский Аргентинский (es-AR), Французский Канадский (fr-CA)

## Структура локализации

### Файлы ресурсов

Все файлы ресурсов находятся в папке `Resources/Languages/`:
- `Resources/Languages/Strings.resx` - Английский (базовый файл)
- `Resources/Languages/Strings.ru.resx` - Русский
- `Resources/Languages/Strings.es.resx` - Испанский
- `Resources/Languages/Strings.fr.resx` - Французский
- `Resources/Languages/Strings.de.resx` - Немецкий
- `Resources/Languages/Strings.it.resx` - Итальянский
- `Resources/Languages/Strings.pt.resx` - Португальский
- И другие языки по аналогии (всего 50 языков)

### Класс LocalizationManager

Класс `LocalizationManager` в `Core/LocalizationManager.cs` управляет локализацией:
- Инициализация локализации при запуске приложения
- Автоматическое определение языка из Windows
- Установка языка вручную
- Получение локализованных строк

## Поддерживаемые языки

Система поддерживает 50+ языков, включая:
- Английский (en)
- Русский (ru)
- Испанский (es)
- Французский (fr)
- Немецкий (de)
- Итальянский (it)
- Португальский (pt)
- Китайский (zh)
- Японский (ja)
- Корейский (ko)
- Арабский (ar)
- Хинди (hi)
- Турецкий (tr)
- Польский (pl)
- И многие другие...

Полный список доступен через `LocalizationManager.GetSupportedLanguages()`.

## Использование

### Получение локализованной строки

```csharp
var text = LocalizationManager.GetString("MainForm_Title");
```

### Установка языка

```csharp
LocalizationManager.SetLanguage("ru");
```

### Получение текущего языка

```csharp
var currentLang = LocalizationManager.GetCurrentLanguage();
```

## Добавление новых языков

1. Создайте файл `Resources/Languages/Strings.{код_языка}.resx` (например, `Strings.it.resx` для итальянского)
2. Скопируйте структуру из `Resources/Languages/Strings.resx` (базовый файл)
3. Замените значения `<value>` на переводы
4. Добавьте язык в `LocalizationManager.GetSupportedLanguages()` если нужно
5. Используйте PowerShell скрипт `Resources/Languages/check_translations.ps1` для проверки переводов

## Добавление новых строк

1. Добавьте строку в `Resources/Languages/Strings.resx` (английский, базовый файл)
2. Добавьте переводы во все языковые файлы в `Resources/Languages/`
3. Используйте `LocalizationManager.GetString("Имя_Ключа")` в коде
4. Используйте PowerShell скрипт `Resources/Languages/check_translations.ps1` для проверки полноты переводов

## Настройка языка в приложении

1. Откройте Настройки (кнопка "Настройки" в главном окне)
2. Выберите язык из выпадающего списка
3. Нажмите "Сохранить"
4. Язык будет применён и сохранён для следующего запуска

## Автоматическое определение языка

При первом запуске приложения:
1. Система пытается определить язык из настроек Windows (`CultureInfo.CurrentUICulture`)
2. Если определение не удалось, используется английский по умолчанию
3. Выбранный язык сохраняется в `appsettings.json` в поле `LanguageCode`

## Тестирование

Запустите тесты локализации:
```bash
dotnet test --filter "LocalizationTests"
```

Тесты проверяют:
- Корректную инициализацию LocalizationManager
- Получение локализованных строк для всех поддерживаемых языков
- Fallback механизм (использование английского при отсутствии перевода)
- Полноту переводов для всех языков

## Инструменты для работы с переводами

### Проверка переводов

Используйте PowerShell скрипт для проверки статуса переводов:
```powershell
cd Resources\Languages
.\check_translations.ps1
```

Скрипт выводит:
- Список полностью переведенных языков
- Список языков, требующих переводов
- Статистику по количеству ключей

**Примечание**: Все PowerShell скрипты настроены на вывод в кодировке UTF-8 для корректного отображения многоязычного контента.

## Расширение локализации

Для полной локализации всех строк в приложении:
1. Найдите все строковые литералы в UI коде
2. Замените их на вызовы `LocalizationManager.GetString()`
3. Добавьте соответствующие ключи в файлы ресурсов
4. Добавьте переводы для всех поддерживаемых языков

## Структура ключей

Ключи локализации организованы по префиксам:
- `MainForm_*` - элементы главной формы
- `GlobalSettings_*` - элементы формы настроек
- `Priority_*` - приоритеты
- `Status_*` - статусы торрентов
- `MessageBox_*` - сообщения